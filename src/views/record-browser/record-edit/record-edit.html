<div class="record-edit-view view-frame" md-whiteframe="4">
  <div class="view-header">
    <h1>Edit Record</h1>

    <md-button class="md-raised md-secondary" ng-click="showRemoveDialog($event)">
      <i class="fa fa-times"></i>
      Delete record
    </md-button>
    <md-button class="md-raised md-primary" ng-click="showAddFieldDialog($event)">
      <i class="fa fa-plus"></i>
      Add field
    </md-button>
  </div>

  <div>
    <md-input-container>
      <label>ID</label>
      <input type="text" disabled ng-model="document_id">
    </md-input-container>
  </div>

	<form name="recordForm" ng-submit="update()">
		<div ng-repeat="(key, value) in record">
			<md-input-container ng-hide="key === 'id' || key === '_meta' || meta[key].datatype === 'boolean'">
				<label>{{ key }}</label>
				<input type="{{ meta[key].datatype }}"
							 name="{{ key }}"
							 ng-model="record[key]"
							 ng-required="meta[key].required"
							 ng-change="validateJSON(record[key], key)">
				<p style="color: #d30915;" ng-show="recordForm[key].$error.required">This field is required</p>
				<p style="color: #d30915" ng-show="!validateJSON(record[key], key)">{{ e }}</p>
			</md-input-container>

			<div ng-hide="meta[key].datatype !== 'boolean'">
				{{ key }}

				<div>
					<md-checkbox ng-model="record[key]"
											 ng-true-value="true"
											 ng-false-value="false">
					</md-checkbox>
					{{ record[key] }}
				</div>
			</div>
		</div>

	  <div style="text-align: right;">
	    <md-button type="submit" class="md-raised md-primary" ng-disabled="recordForm.$invalid">
	      Save
	    </md-button>
	  </div>
	</form>


  <div style="visibility: hidden">
    <div class="md-dialog-container" id="myDialog">
      <md-dialog>
        <h2 style="padding: 25px 25px 0">Add field</h2>

				<form name="addFieldForm" ng-submit="answer()" style="padding: 0 25px 25px">

	        <div class="group">
	          <md-input-container>
	            <label>Field name</label>
	            <input type="text" ng-model="newField.field" required>
	          </md-input-container>
	        </div>

					<div class="group">
						<md-input-container>
							<label>Data type</label>
							<md-select ng-model="newField.datatype" required>
								<md-option value="text">text</md-option>
								<md-option value="number">number</md-option>
								<md-option value="boolean">boolean</md-option>
								<md-option value="array">array</md-option>
								<md-option value="object">object</md-option>
							</md-select>
						</md-input-container>
					</div>

	        <div class="group" ng-hide="newField.datatype === 'boolean'">
	          <md-input-container>
	            <label>Field value</label>
	            <input type="{{ newField.datatype === 'number' ? 'number' : 'text' }}" ng-model="newField.value" ng-required="newField.datatype !== 'boolean'">
	          </md-input-container>
	        </div>

					<div class="group" ng-hide="newField.datatype !== 'boolean'" id="skip-margin">
						<md-radio-group ng-model="newField.value">
							<md-radio-button value="true" aria-label="true">true</md-radio-button>
							<md-radio-button value="false" aria-label="false">false</md-radio-button>
						</md-radio-group>
					</div>

					<div style="padding: 5px; text-align: right;">
						<md-button class="md-raised md-secondary" ng-click="cancel()">Cancel</md-button>
						<md-button type="submit"
											 style="margin-left: 15px;"
											 class="md-raised md-primary"
											 ng-disabled="addFieldForm.$invalid">Add
						</md-button>
					</div>
				</form>
      </md-dialog>
    </div>
  </div>
</div>
